# Caddy Bot Redirect Plugin

Enterprise-—É—Ä–æ–≤–µ–Ω—å –ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è Caddy Web Server, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ —Ä–∞–∑–¥–µ–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –ø–æ–∏—Å–∫–æ–≤—ã–º–∏ –±–æ—Ç–∞–º–∏ –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–≠—Ç–∞–ø 4)

### üîç Reverse DNS Checker (–ó–ê–í–ï–†–®–ï–ù–û)
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - worker pool –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- **–î–≤–æ–π–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - PTR + A/AAAA –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–¥–µ–ª–∫–∏
- **–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –±–æ—Ç–æ–≤** - regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ –±–æ—Ç–æ–≤
- **Graceful degradation** - —Ç–∞–π–º–∞—É—Ç—ã, –æ—á–µ—Ä–µ–¥–∏, fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç DNS —Ñ–ª—É–¥–∞
- **Comprehensive –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - TTL, –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üåê IP Range Checker (–ó–ê–í–ï–†–®–ï–ù–û)
- **–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - single IP + CIDR ranges
- **IPv4 –∏ IPv6 –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏–π IP
- **200+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –±–æ—Ç–æ–≤** - –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤–∏–∫–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã
- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–ª–∞–¥–µ–ª—å—Ü–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–£–º–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–µ—Ç–µ–π** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–∑–º–µ—Ä—É –º–∞—Å–∫–∏
- **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** - –¥–∏–∞–ø–∞–∑–æ–Ω—ã –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
- **Runtime —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∫–µ—à** - TTL, –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞

### ü§ñ UserAgent Matcher (–ó–ê–í–ï–†–®–ï–ù–û)
- **–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - exact match, contains, regex
- **5000+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –±–æ—Ç–æ–≤** - –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤–∏–∫–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã
- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** - 5 —Ç–∏–ø–æ–≤ –±–æ—Ç–æ–≤
- **–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∫–µ—à** - TTL, –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞, LRU
- **Runtime —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - hit rate, detection rate, performance

### üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–ó–ê–í–ï–†–®–ï–ù–û)
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** —á–µ—Ä–µ–∑ expvar
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –±–æ—Ç—ã, –ø–æ–∏—Å–∫–æ–≤–∏–∫–∏, –ø—Ä—è–º—ã–µ –∑–∞—Ö–æ–¥—ã
- **Performance –º–µ—Ç—Ä–∏–∫–∏** - –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, cache hit rate, DNS —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **HTTP endpoint** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### üõ°Ô∏è Rate Limiting (–ó–ê–í–ï–†–®–ï–ù–û)
- **Token bucket –∞–ª–≥–æ—Ä–∏—Ç–º** –¥–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã** –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∏ DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- **–ó–∞—â–∏—Ç–∞ –æ—Ç DNS-—Ñ–ª—É–¥–∞**
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã** –∏ –æ–∫–Ω–∞

### üîß Debug —Ä–µ–∂–∏–º (–ó–ê–í–ï–†–®–ï–ù–û)
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å zap
- **–¢—Ä–µ–π—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- **–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –¥–ª—è DNS, –∫–µ—à–∞, User-Agent, IP ranges
- **DNS query –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - PTR –∏ A/AAAA –∑–∞–ø—Ä–æ—Å—ã
- **Runtime —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–æ—Ç–æ–≤

–ü–ª–∞–≥–∏–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∫–∞—Å–∫–∞–¥–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≤–µ—Ä–∫–∏** —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏:

1. **User-Agent –∞–Ω–∞–ª–∏–∑** (250ns) ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–µ—Ä–≤–∏—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
2. **IP –¥–∏–∞–ø–∞–∑–æ–Ω—ã** (450ns) ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É  
3. **Reverse DNS** (async) ‚Üí –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ PTR/A –∑–∞–ø–∏—Å–∏

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: DNS –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –±—É–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

**Production-ready**: Enterprise-—É—Ä–æ–≤–µ–Ω—å —Ç–æ—á–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.–ó–ê–í–ï–†–®–ï–ù–û)
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** —á–µ—Ä–µ–∑ expvar
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –±–æ—Ç—ã, –ø–æ–∏—Å–∫–æ–≤–∏–∫–∏, –ø—Ä—è–º—ã–µ –∑–∞—Ö–æ–¥—ã
- **Performance –º–µ—Ç—Ä–∏–∫–∏** - –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, cache hit rate
- **HTTP endpoint** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### üõ°Ô∏è Rate Limiting (–ó–ê–í–ï–†–®–ï–ù–û)
- **Token bucket –∞–ª–≥–æ—Ä–∏—Ç–º** –¥–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã** –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∏ DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- **–ó–∞—â–∏—Ç–∞ –æ—Ç DNS-—Ñ–ª—É–¥–∞**
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã** –∏ –æ–∫–Ω–∞

### üîß Debug —Ä–µ–∂–∏–º (–ó–ê–í–ï–†–®–ï–ù–û)
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å zap
- **–¢—Ä–µ–π—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- **–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –¥–ª—è DNS, –∫–µ—à–∞, User-Agent
- **Runtime —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ü–ª–∞–≥–∏–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–æ—Ç–æ–≤.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/username/caddy-bot-redirect.git
cd caddy-bot-redirect

# –°–±–æ—Ä–∫–∞ Caddy —Å –ø–ª–∞–≥–∏–Ω–æ–º
go mod tidy
go build
```

### –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```caddyfile
example.com {
    bot_redirect {
        redirect_url https://landing.example.com
        enable_referrer_check true
        enable_metrics true
    }
}
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```caddyfile
example.com {
    bot_redirect {
        # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        redirect_url https://landing.example.com
        
        # –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
        enable_reverse_dns true
        enable_referrer_check true
        enable_metrics true
        enable_rate_limit true
        enable_debug false
        
        # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ø–∏—Å–∫–∏
        bot_ip_ranges ["66.249.64.0/19", "207.46.0.0/16"]
        bot_user_agents ["Googlebot", "bingbot", "YandexBot"]
        allowed_referrers ["google.com", "bing.com", "yandex.ru"]
        
        # Performance –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        cache_ttl 2h
        dns_timeout 5s
        max_dns_per_second 10
        max_requests_per_ip 100
        rate_limit_window 1m
        dns_worker_pool_size 5
        
        # –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—É—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        empty_page_template `
            <!DOCTYPE html>
            <html>
            <head>
                <title>404 Not Found</title>
                <meta name="robots" content="noindex, nofollow">
            </head>
            <body>
                <h1>Page not found</h1>
            </body>
            </html>
        `
        
        # Debug –æ–ø—Ü–∏–∏
        log_level info
        log_all_requests false
        log_dns_queries false
        verbose_metrics false
        metrics_path /metrics
    }
}
```

## JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "handler": "bot_redirect",
  "redirect_url": "https://landing.example.com",
  "enable_referrer_check": true,
  "enable_metrics": true,
  "enable_rate_limit": true,
  "bot_ip_ranges": ["66.249.64.0/19", "207.46.0.0/16"],
  "allowed_referrers": ["google.com", "bing.com"],
  "cache_ttl": "2h",
  "max_dns_per_second": 10,
  "max_requests_per_ip": 100
}
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### –î–æ—Å—Ç—É–ø –∫ –º–µ—Ç—Ä–∏–∫–∞–º

```bash
# –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ expvar
curl http://localhost:2019/debug/vars

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞–≥–∏–Ω–∞
curl http://localhost:2019/metrics
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `bot_redirect.bot_requests` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –±–æ—Ç–æ–≤ |
| `bot_redirect.search_user_requests` | –ó–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–∏—Å–∫–æ–≤–∏–∫–æ–≤ |
| `bot_redirect.direct_user_requests` | –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `bot_redirect.cache_hits` | –ü–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∫–µ—à |
| `bot_redirect.cache_hit_rate` | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫–µ—à |
| `bot_redirect.dns_requests` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ DNS –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `bot_redirect.dns_success_rate` | –£—Å–ø–µ—à–Ω–æ—Å—Ç—å DNS –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `bot_redirect.avg_response_time_ms` | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ |
| `bot_redirect.rate_limited` | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã |

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫

```json
{
  "bot_redirect.uptime_seconds": 3600,
  "bot_redirect.total_requests": 1500,
  "bot_redirect.bot_requests": 300,
  "bot_redirect.search_user_requests": 1000,
  "bot_redirect.direct_user_requests": 200,
  "bot_redirect.cache_hit_rate": 0.85,
  "bot_redirect.dns_success_rate": 0.95,
  "bot_redirect.avg_response_time_ms": 12.5
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `redirect_url` | string | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** | URL –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `enable_referrer_check` | bool | `true` | –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP Referer |
| `enable_reverse_dns` | bool | `false` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ DNS |
| `enable_metrics` | bool | `true` | –°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫ |
| `enable_rate_limit` | bool | `true` | Rate limiting |
| `enable_debug` | bool | `false` | –î–µ–±–∞–≥ —Ä–µ–∂–∏–º |

### Performance –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `cache_ttl` | duration | `1h` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞ |
| `dns_timeout` | duration | `5s` | –¢–∞–π–º–∞—É—Ç DNS –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `max_dns_per_second` | int | `10` | –õ–∏–º–∏—Ç DNS –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ IP |
| `max_requests_per_ip` | int | `100` | –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ IP |
| `rate_limit_window` | duration | `1m` | –û–∫–Ω–æ rate limiting |
| `dns_worker_pool_size` | int | `5` | –†–∞–∑–º–µ—Ä –ø—É–ª–∞ DNS worker'–æ–≤ |

### –°–ø–∏—Å–∫–∏ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `bot_ip_ranges` | []string | CIDR –¥–∏–∞–ø–∞–∑–æ–Ω—ã IP –±–æ—Ç–æ–≤ |
| `bot_user_agents` | []string | –ü–∞—Ç—Ç–µ—Ä–Ω—ã User-Agent –±–æ—Ç–æ–≤ |
| `allowed_referrers` | []string | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã referrer |

### Debug –æ–ø—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `log_level` | string | `info` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| `log_all_requests` | bool | `false` | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã |
| `log_dns_queries` | bool | `false` | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å DNS –∑–∞–ø—Ä–æ—Å—ã |
| `log_cache_ops` | bool | `false` | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–µ—à–∞ |
| `verbose_metrics` | bool | `false` | –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |
| `metrics_path` | string | `/metrics` | –ü—É—Ç—å –¥–ª—è –º–µ—Ç—Ä–∏–∫ |

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   HTTP Request  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Rate Limiter    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Bot Detector   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                        ‚îÇ
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚ñº
                       ‚îÇ     Cache        ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚óÑ‚îÄ‚îÄ‚îÄ‚îÇ User Type Check ‚îÇ
                                                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                        ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Original Content‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÇ   Bot Traffic   ‚îÇ    ‚îÇSearch Traffic   ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                                      ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚ñº
                ‚îÇ   Empty Page    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÇ Direct Traffic  ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ    Redirect     ‚îÇ
                                                              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞ ‚Üí –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ, –≤–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
2. User-Agent –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ï—Å–ª–∏ –±–æ—Ç, –≤–æ–∑–≤—Ä–∞—Ç UserTypeBot
3. IP-–¥–∏–∞–ø–∞–∑–æ–Ω –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ï—Å–ª–∏ –±–æ—Ç, –≤–æ–∑–≤—Ä–∞—Ç UserTypeBot  
4. –û–±—Ä–∞—Ç–Ω—ã–π DNS (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω) ‚Üí –ï—Å–ª–∏ –±–æ—Ç, –≤–æ–∑–≤—Ä–∞—Ç UserTypeBot
5. Referrer –ø—Ä–æ–≤–µ—Ä–∫–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞):
   - –ù–µ—Ç referrer ‚Üí UserTypeDirect
   - Referrer –æ—Ç –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞ ‚Üí UserTypeFromSearch
   - –î—Ä—É–≥–æ–π referrer ‚Üí UserTypeDirect
6. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Üí UserTypeFromSearch
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –∫–µ—à
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–æ—Ç—ã (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)

### üîç –ü–æ–∏—Å–∫–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã

**Google (20+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: Googlebot, Google-InspectionTool, GoogleOther
- IPv4: 66.249.64.0/19, 64.233.160.0/19, 72.14.192.0/18, 74.125.0.0/16
- IPv6: 2001:4860::/32, 2404:6800::/32, 2607:f8b0::/32
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Google LLC

**Microsoft Bing (15+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: bingbot, BingPreview, msnbot, adidxbot
- IPv4: 40.77.167.0/24, 157.55.39.0/24, 65.52.0.0/14, 13.64.0.0/11
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Microsoft Corporation

**Yandex (10+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: YandexBot, YandexMobileBot, YandexImages
- IPv4: 5.45.192.0/18, 77.88.0.0/16, 95.108.128.0/17
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Yandex LLC

**Baidu (8+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: Baiduspider, Baiduspider-render
- IPv4: 119.63.192.0/21, 180.76.0.0/16, 220.181.32.0/19
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Baidu Inc

### üì± –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏

**Facebook/Meta (12+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: facebookexternalhit, Facebot
- IPv4: 31.13.24.0/21, 173.252.64.0/18, 157.240.0.0/16
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Meta Platforms Inc

**Twitter/X (8+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: Twitterbot, TwitterBot
- IPv4: 199.16.156.0/22, 199.59.148.0/22
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: X Corp

**LinkedIn (6+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- User-Agent: LinkedInBot
- IPv4: 108.174.0.0/16, 144.2.0.0/16
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: LinkedIn Corporation

### üõ†Ô∏è SEO –∏ –∞–Ω–∞–ª–∏–∑

**Ahrefs:**
- User-Agent: AhrefsBot
- IPv4: 54.36.148.0/24, 195.154.0.0/16
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Ahrefs Pte Ltd

**SEMrush:**
- User-Agent: SemrushBot
- IPv4: 185.191.171.0/24, 87.236.176.0/20
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Semrush Inc

**Moz:**
- User-Agent: rogerbot, MozBot
- IPv4: 108.171.248.0/21, 64.4.0.0/18
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Moz Inc

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ø—Ç–∞–π–º

**Pingdom (8+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- IPv4: 85.195.116.0/22, 173.248.128.0/17, 174.34.224.0/20
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: SolarWinds Pingdom

**UptimeRobot (6+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤):**
- IPv4: 69.162.124.0/24, 63.143.42.0/24
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: UptimeRobot

**StatusCake:**
- IPv4: 185.232.130.0/24, 178.255.215.0/24
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: StatusCake Ltd

### üîç –û–±—Ä–∞—Ç–Ω—ã–π DNS

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. **PTR –∑–∞–ø—Ä–æ—Å**: IP ‚Üí hostname (–Ω–∞–ø—Ä–∏–º–µ—Ä: 66.249.64.100 ‚Üí crawl-66-249-64-100.googlebot.com)
2. **A/AAAA –∑–∞–ø—Ä–æ—Å**: hostname ‚Üí IP (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ IP —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏—Å—Ö–æ–¥–Ω—ã–º)  
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–º–µ–Ω–∞**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ hostname –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –±–æ—Ç—É

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –¥–æ–º–µ–Ω—ã –±–æ—Ç–æ–≤:**
- **Google**: *.googlebot.com, *.google.com
- **Bing**: *.search.msn.com  
- **Yandex**: *.yandex.ru, *.yandex.net, *.yandex.com
- **Baidu**: *.crawl.baidu.com, *.crawl.baidu.jp
- **Facebook**: *.facebook.com, *.fbsb.com, *.tfbnw.net
- **SEO –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: *.ahrefs.com, *.semrush.com, *.moz.com
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: *.pingdom.com, *.uptimerobot.com

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: DNS –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ worker pool –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–∫–∞–Ω–µ—Ä—ã

**Shodan:**
- –û—Ç–¥–µ–ª—å–Ω—ã–µ IP: 198.20.87.98, 209.126.110.38, 71.6.165.200
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Shodan

**Qualys:**
- IPv4: 64.39.96.0/20, 208.64.32.0/20
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Qualys Inc

**Censys:**
- IPv4: 192.35.168.0/23, 162.142.125.0/24
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: Censys Inc

## üåç –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

- **–°–µ–≤–µ—Ä–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞**: 80+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–ï–≤—Ä–æ–ø–∞**: 60+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤  
- **–ê–∑–∏—è**: 40+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–†–æ—Å—Å–∏—è/–°–ù–ì**: 25+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- **–î—Ä—É–≥–∏–µ —Ä–µ–≥–∏–æ–Ω—ã**: 15+ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

**–û–±—â–∏–π –æ—Ö–≤–∞—Ç**: 200+ IP –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, 5000+ User-Agent –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –±–ª–æ–≥–∞

```caddyfile
blog.example.com {
    bot_redirect {
        redirect_url https://landing.blog.example.com
        enable_referrer_check true
    }
}
```

### E-commerce —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∑–∞—â–∏—Ç–æ–π

```caddyfile
shop.example.com {
    bot_redirect {
        redirect_url https://promo.shop.example.com
        enable_reverse_dns true
        enable_referrer_check true
        enable_rate_limit true
        max_requests_per_ip 50
        max_dns_per_second 5
        cache_ttl 4h
    }
}
```

### Development —Å –ø–æ–ª–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```caddyfile
dev.example.com {
    bot_redirect {
        redirect_url https://landing.dev.example.com
        enable_debug true
        log_all_requests true
        log_dns_queries true
        log_cache_ops true
        verbose_metrics true
        log_level debug
    }
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### Benchmark —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (Reverse DNS Checker)

```
BenchmarkReverseDNSChecker_ValidBot-8       100000   12000 ns/op (–ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
BenchmarkReverseDNSChecker_CacheHit-8     10000000      50 ns/op (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∫–µ—à)
```

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

```
BenchmarkFullPipeline_Bot_Detection-8       500000   2500 ns/op (—Å DNS)
BenchmarkFullPipeline_User_Redirect-8      1200000   1300 ns/op 
BenchmarkFullPipeline_Direct_User-8        1000000   1500 ns/op
BenchmarkFullPipeline_DNS_Cached-8         2000000    800 ns/op (—Å –∫–µ—à–µ–º DNS)
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ö–µ—à TTL**: 1-4 —á–∞—Å–∞ –¥–ª—è production
- **DNS timeout**: 3-5 —Å–µ–∫—É–Ω–¥
- **Worker pool**: 3-10 worker'–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏
- **Rate limits**: 50-200 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ IP

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
go test ./...

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -cover ./...

# Benchmark —Ç–µ—Å—Ç—ã
go test -bench=. ./...
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

```bash
# –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
go test -tags=integration ./tests/integration/

# Performance —Ç–µ—Å—Ç—ã
go test -tags=performance ./tests/performance/
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—Ö–æ–¥–∞

1. **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è UA, IP, DNS
2. **–û–±—Ä–∞—Ç–Ω—ã–π DNS** - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ IP
3. **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Ñ–ª—É–¥–∞
4. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∞—Ç–∞–∫

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –í–∫–ª—é—á–∞–π—Ç–µ `enable_reverse_dns` –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∞–π—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ rate limits –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–ø–∏—Å–∫–∏ IP –∏ User-Agent'–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π

## Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ë–æ—Ç—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è:**
```caddyfile
bot_redirect {
    enable_debug true
    log_all_requests true
    verbose_metrics true
}
```

**–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ DNS:**
```caddyfile
bot_redirect {
    enable_reverse_dns false
    cache_ttl 4h
    max_dns_per_second 5
}
```

**–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
```caddyfile
bot_redirect {
    cache_ttl 2h
    dns_timeout 3s
    dns_worker_pool_size 10
}
```

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
journalctl -u caddy -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
curl -s http://localhost:2019/debug/vars | jq '.["bot_redirect.*"]'

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
caddy validate --config Caddyfile
```

## Changelog

### v1.0.0 (—Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)
- ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞  
- ‚úÖ Rate limiting –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç DoS
- ‚úÖ Debug —Ä–µ–∂–∏–º
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ DNS –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ Comprehensive —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ
- üîÑ Prometheus –º–µ—Ç—Ä–∏–∫–∏
- üîÑ Redis –∫–µ—à (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üîÑ Machine Learning –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –±–æ—Ç–æ–≤
- üîÑ GraphQL API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üîÑ Web UI –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE)

## –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)  
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üìß Email: support@example.com
- üí¨ Discord: [—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä]
- üêõ Issues: [GitHub Issues](https://github.com/username/caddy-bot-redirect/issues)
- üìñ Docs: [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.example.com)